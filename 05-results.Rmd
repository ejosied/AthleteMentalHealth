# Results


## How are identification with sports and mental health correlated?


## How are individual/community connection to sports and mental health correlated?

```{r, echo=FALSE} 
library(tidyverse)
library(magrittr)
``` 

```{r}
#load dataset
load("~/Documents/MSDS/EDAV/Final Project Data/DS0001/33661-0001-Data.rda")
df <- da33661.0001

#abbreviate column names for graphing purposes
names(df) <- abbreviate(names(df))
```

```{r}
#mental health variables
MH_subset <- dplyr::select(df, CASEID, CESD01, CESD02, CESD03, CESD04, CESD05, CESD06, CESD07, CESD08, CESD09, CESD10)

#sport
college_sport <- df %>% 
  select("CASEID", starts_with("TS"))

community_sport <- df %>%
  select("CASEID", starts_with("TC"))

#personal feelings about athletic involvement 
Sxn_5 <- df %>% 
  select("CASEID", (starts_with("MPSQ")), starts_with("SOQ"), starts_with("TEOSQ"), starts_with("SSQ") , starts_with("AIQ"), starts_with("GENWIN"))
```

```{r}
#visualize college sports played 
#tidy data for college sport data 
tidy_college <- college_sport %>%
  pivot_longer(!c("CASEID"), names_to = "Sport_Year", values_to = "participated" ) %>%
  filter(participated == '(1) Marked') %>%
  separate(Sport_Year, into = c('year', 'sport'), sep = 4) %>%
  mutate(year = case_when(
    year == 'TSFR' ~ 'Freshman',
    year == 'TSSO' ~ 'Sophomore', 
    year == 'TSJR' ~ 'Junior',
    year == 'TSSE' ~ 'Senior'
    )) %>%
  mutate(sport = case_when(
    sport == 'BX' ~ 'Boxing',
    sport == 'BB' ~ 'Baseball', 
    sport == 'BK' ~ 'Basketball',
    sport == 'BL' ~ 'Bowling',
    sport == 'CH' ~ 'Cheerleading',
    sport == 'CC' ~ 'Cross_Country',
    sport == 'DN' ~ 'Dance', 
    sport == 'FH' ~ 'Field_Hockey',
    sport == 'FB' ~ 'Football',
    sport == 'GF' ~ 'Golf', 
    sport == 'GM' ~ 'Gymnastics', 
    sport == 'IH' ~ 'Ice_Hockey',
    sport == 'LC' ~ 'Lacrosse', 
    sport == 'RG' ~ 'Rugby', 
    sport == 'SK' ~ 'Skiing',
    sport == 'SC' ~ 'Soccer',
    sport == 'SB' ~ 'Softball', 
    sport == 'SW' ~ 'Swimming', #swimming and diving
    sport == 'TN' ~ 'Tennis',
    sport == 'TF' ~ 'Track', #track and field
    sport == 'VB' ~ 'Volleyball',
    sport == 'WR' ~ 'Wrestling', 
    sport == 'O1' ~ 'Other', 
    sport == 'O2' ~ 'Other', 
    sport == 'NO' ~ 'No_Teams'
  )) %>%
  select(CASEID, year, sport)

```

```{r}
#Sport Groupings: 
#Individual Sport: Boxing, Bowling (?), Cross Country, Dance, Golf, Gymnastics, Skiing, Swimming & Diving, Tennis, Track and Field, Wrestling
#Teams Sport: Baseball, Basketball, Cheerleading, Field Hockey, Football, Ice Hockey, Lacrosse, Rugby, Soccer, Softball, Volleyball

individual_sport = c('Boxing', 'Bowling','Cross_Country', 'Dance', 'Golf', 'Gymnastics', 'Skiing', 'Swimming', 'Tennis', 'Track', 'Wrestling')

#dataframe with team & indv groupings and removing other and no teams
tidy_college_group <- tidy_college %>% 
  subset(sport!='Other' & sport!='No_Teams') %>%
  mutate(sport_group = ifelse(sport %in% individual_sport, 'Individual', 'Team'))
```

```{r}
sport_facet_year <- ggplot(tidy_college_group, aes(fct_rev(fct_infreq(sport)))) + 
  geom_bar(fill = 'lightblue') + 
  facet_wrap(~fct_inorder(year)) +
  coord_flip() +
  ggtitle("College Sports Played per Year") +
  xlab("Sport") +
  ylab("Count") +
  theme_bw(10)

sport_dist <- ggplot(tidy_college_group, aes(fct_rev(fct_infreq(sport)), fill = sport_group)) + 
  geom_bar() + 
  coord_flip() +
  ggtitle("College Sports Played") +
  xlab("Sport") +
  ylab("Count") +
  theme_bw(12)

sport_dist
sport_facet_year
```

## Observations

* The most popular sports played by respondents are Track & Field, Basketball, and Soccer. 

* The spread of responses is quite even across years in college, with no year with significantly less or more respondants than another. 

## Mental Health Data Exploration

* The questions related to mental health were asked in the following manner: "Below is a list of some of the ways you may have felt or behaved recently. Please indicate how often you have felt this way during the past week."


```{r}
#factor to numeric for MH_outcomes columns, likert takes factor data, so comment out! 
MH_subset_numeric <- MH_subset 
MH_subset_numeric[] <- lapply(MH_subset, as.numeric) 


#rename columns with question for plotting
MH_subset <- MH_subset  %>% 
  rename("Bothered by things that usually don't bother me" = CESD01,
        "Trouble keeping mind on what I was doing" = CESD02,
        "Depressed" = CESD03,
        "Everything was an effort" = CESD04,
        "Hopeful about future" = CESD05,
        "Fearful" = CESD06,
        "Sleep was restless" = CESD07, 
        "Happy" = CESD08,
        "Lonely" = CESD09,
        "Could not get going" = CESD10)

##diverging stacked barchart to show MH 
library(likert)
library(RColorBrewer)

MH_summary <- likert(MH_subset[,c(2:11)])

# use function likert() to plot survey data
plot(MH_summary, main = "Mental Health Responses", col =) 

```

```{r}
#check correlation between depressed CESD03 and sport team 
#merge df's on caseid 

depressed_sport <- left_join(MH_subset_numeric[,c(1, 4)], tidy_college_group) %>%
  group_by(CASEID) %>%
  rename("Depressed" = CESD03) %>%
  drop_na() 
  
depressed <- ggplot(depressed_sport, aes(x=Depressed)) +
  geom_bar() +
  facet_wrap(~sport_group) 

happy_sport <- left_join(MH_subset_numeric[, c(1,9)], tidy_college_group) %>%
  rename("Happy" = CESD08) %>%
  group_by(CASEID) %>%
  drop_na()

happy <- ggplot(happy_sport, aes(x=Happy)) +
  geom_bar() +
  facet_wrap(~sport_group) 

grid.arrange(depressed, happy, ncol=2)

## ^ plot needs to be better but first view at happy vs. depressed results for college athletes 
## plots are also counting duplicate counts per student. Want to keep levels per sport but for these plots we don't need 
## each row to count for one, each caseID should count as one....
```





