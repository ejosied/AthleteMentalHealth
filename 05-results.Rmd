---
output: html_document
editor_options: 
  chunk_output_type: inline
---
# Results

```{r, echo=FALSE} 
library(tidyverse)
library(magrittr)
library(dplyr)
library(vcd)
library(RColorBrewer)
library(ggplot2)
library(gridExtra)
library(cowplot)
library(ggcorrplot)
library(HH)
library(ggalluvial)
``` 

```{r}
#load dataset
load("~/Documents/MSDS/EDAV/Final Project Data/DS0001/33661-0001-Data.rda")
df <- da33661.0001
```

```{r}
# define function to indicate whether or not a student has indicated that they have done a sport
is_marked <- function(x) x == "(1) Marked"
```

```{r}
get_indicators <- function(s){
  
  sports <- c("Boxing", "Baseball", "Basketball", "Bowling", "Cheerleading", "Cross Country", "Dance", "Field Hockey", "Football", "Golf", "Gymnastics", "Ice Hockey", "Lacross", "Rugby", "Skiing", "Soccer", "Swimming", "Tennis", "Track", "Volleyball", "Wrestling")
  sport_codes <- c("BX", "BB", "BK", "BL", "CH", "CC", "DN", "FH", "FB", "GF", "GM", "IH", "LC", "RG", "SK", "SC", "SB", "SW", "TN", "TF", "VB", "WR")
  
  index <- match(s, sports)
  sport_code <- sport_codes[index]
  
  prefixes <- c("TSFR", "TSSO", "TSJR", "TSSE", "TCFR", "TCSO", "TCJR", "TCSE", "TPCL", "TPCM")
  indic <- c()
  for(p in prefixes){
    indic <- c(indic, paste(p, sport_code, sep=""))
  }
  
  return(indic)
}
```

```{r}
df_recoded <- function(data, v) {
  
  positive_mh <- c("CESD05", "CESD08")
  negative_mh <- c("CESD01", "CESD02", "CESD03", "CESD04", "CESD06", "CESD07", "CESD09", "CESD10")
  
  motivation_int <- c("MPSQ01", "MPSQ02", "MPSQ03", "MPSQ06", "MPSQ09", "MPSQ11", "MPSQ14", "MPSQ17", "MPSQ20", "MPSQ21", "MPSQ22", "MPSQ23", "MPSQ25")
  motivation_ext <- c("MPSQ04", "MPSQ05", "MPSQ07", "MPSQ08", "MPSQ10", "MPSQ12", "MPSQ13", "MPSQ15", "MPSQ16", "MPSQ18", "MPSQ19", "MPSQ24")
  
  success_hardwork <- c("TEOSQ02", "TEOSQ05", "TEOSQ07", "TEOSQ08", "TEOSQ10", "TEOSQ13")
  success_ego <- c("TEOSQ01", "TEOSQ03", "TEOSQ04", "TEOSQ06", "TEOSQ09", "TEOSQ11", "TEOSQ12")
  
  behavior_cautious <- c("GENRIS02", "GENRIS03", "GENRIS07", "GENRIS09", "GENRIS10", "GENRIS12", "GENRIS13", "GENRIS14", "GENRIS17", "GENRIS18")
  behavior_risky <- c("GENRIS01", "GENRIS04", "GENRIS05", "GENRIS06", "GENRIS08", "GENRIS11", "GENRIS15", "GENRIS16")
  
  if(startsWith(v, "CESD")){
    if(v %in% positive_mh){
      data <- data %>%
        mutate_at(c(v), funs(fct_recode(.,`-2` = "(1) Rarely or none of the time (less than 1 day)", `-1` = "(2) Some or a little of the time (1-2 days)", `1` = "(3) Occasionally or a moderate amount of time (3-4 days)", `2` = "(4) All of the time (5-7 days)")))
    }
    else if(v %in% negative_mh){
      data <- data %>%
        mutate_at(c(v), funs(fct_recode(.,`2` = "(1) Rarely or none of the time (less than 1 day)", `1` = "(2) Some or a little of the time (1-2 days)", `-1` = "(3) Occasionally or a moderate amount of time (3-4 days)", `-2` = "(4) All of the time (5-7 days)")))
    }
  }
  
  else if(startsWith(v, "MPSQ")){
    if(v %in% motivation_int){
      data <- data %>%
        mutate_at(c(v), funs(fct_recode(., `-2` = "(1) Not Important at All", `-1` = "(2) Not Very Important", `0` = "(3) Somewhat Important", `1` = "(4) Pretty Important", `2` = "(5) Extremely Important")))
    }
    else if(v %in% motivation_ext){
      data <- data %>%
        mutate_at(c(v), funs(fct_recode(., `2` = "(1) Not Important at All", `1` = "(2) Not Very Important", `0` = "(3) Somewhat Important", `-1` = "(4) Pretty Important", `-2` = "(5) Extremely Important")))
    }
  }
  
  else if(startsWith(v, "TEOSQ")){
    if(v %in% success_hardwork){
      data <- data %>%
        mutate_at(c(v), funs(fct_recode(., `-2` = "(1) Doesn't Describe Me At All", `-1` = "(2) Describes Me a Little", `0` = "(3) Describes Me Somewhat", `1` = "(4) Describes Me Pretty Well", `2` = "(5) Describes Me Extremely Well")))
    }
    else if(v %in% success_ego){
      data <- data %>%
        mutate_at(c(v), funs(fct_recode(., `2` = "(1) Doesn't Describe Me At All", `1` = "(2) Describes Me a Little", `0` = "(3) Describes Me Somewhat", `-1` = "(4) Describes Me Pretty Well", `-2` = "(5) Describes Me Extremely Well")))
    }
  }
  
  else if(startsWith(v, "GENRI")){
    if(v %in% behavior_cautious){
      data <- data %>%
        mutate_at(c(v), funs(fct_recode(., `-2` = "(1) Strongly Disagree", `-1` = "(2) Disagree", `1` = "(3) Agree", `2` = "(4) Strongly Agree")))
    }
    else if(v %in% behavior_risky){
      data <- data %>%
        mutate_at(c(v), funs(fct_recode(., `2` = "(1) Strongly Disagree", `1` = "(2) Disagree", `-1` = "(3) Agree", `-2` = "(4) Strongly Agree")))
    }
  }

  
  # if(v %in% negative_mh || v %in% motivation_ext || v %in% success_ego){
  #   data <- data %>%
  #     mutate_at(c(v), funs(as.factor(-1 * as.numeric(.))))
  # }
  
  
  else if(startsWith(v, "PSPORT")){
    data <- data %>%
      mutate_at(c(v), funs(fct_recode(.,
          `Badminton` = "(01) Badminton",                          
          `Baseball` = "(02) Baseball",
          `Basketball` = "(03) Basketball",
          `Bowling` = "(04) Bowling",
          `Boxing` = "(05) Boxing / Martial arts",
          `Cheerleading` = "(06) Cheer / Spirit",
          `Cross Country` = "(07) Cross country",
          `Dance` = "(08) Dance team",
          `Equestrian` = "(09) Equestrian",
          `Field Hockey` = "(11) Field hockey",
          `Figure Skating` = "(12) Figure skating",
          `Football` = "(13) Football",
          `Golf` = "(14) Golf",
          `Gymnastics` = "(15) Gymnastics",
          `Ice Hockey` = "(16) Ice hockey / Roller hockey",
          `Lacrosse` = "(17) Lacrosse",
          `Rugby` = "(18) Rugby",
          `Skiing` = "(19) Skiing",
          `Soccer` = "(20) Soccer",
          `Softball` = "(21) Softball",
          `Swimming` = "(22) Swimming / Diving",
          `Tennis` = "(23) Tennis / Racquetball",
          `Track` = "(24) Track and field",
          `Volleyball` = "(25) Volleyball",
          `Wrestling` = "(26) Wrestling",
          `Snowboarding` = "(27) Snowboarding",
          `Weightlifting` = "(28) Weightlifting",
          `Handball` = "(29) Handball",
          `Rowing` = "(30) Rowing / Crew",
          `Cricket` = "(31) Cricket",
          `Ping Pong` = "(32) Ping pong",
          `Colorguard` = "(33) Color / Winterguard",
          `Other` = "(66) Other sport"
      )))
  }
  
  else{
    data <- data
  }
  
  return(data)
}
```


```{r}
vars_by_sport <- function(data_frame, sport, var1, var2) {
  
  indicators <- get_indicators(sport)
  
  q1_df <- data_frame %>%
    filter(if_any(indicators, is_marked)) %>%
    dplyr::select("CASEID", all_of(var1), all_of(var2)) %>%
    filter(complete.cases(.))
  
  q1_df <- df_recoded(q1_df, var1)
  q1_df <- df_recoded(q1_df, var2)
  
  return(q1_df)
  
}
```


```{r}
# obtain different "scores" to measure different areas of health and wellness

# modify data frame
df_sports <- mutate(df, sport = "")
df_sports <- df_recoded(df_sports, "PSPORT")

# sports <- as.character(df_sports$PSPORT)
sports <- c("Boxing", "Baseball", "Basketball", "Bowling", "Cheerleading", "Cross Country", "Dance", "Field Hockey", "Football", "Golf", "Gymnastics", "Ice Hockey", "Lacrosse", "Rugby", "Skiing", "Soccer", "Swimming", "Tennis", "Track", "Volleyball", "Wrestling")

# for(s in sports){
#   df_sports <- df_sports %>%
#     rowwise() %>%
#     mutate(sport = case_when(
#         (if_any(get_indicators(s), is_marked) || as.character(PSPORT) == s) && sport == "" ~ s,
#         (if_any(get_indicators(s), is_marked) || as.character(PSPORT) == s) && !(sport == "") ~ paste(sport, s, sep=", "),
#         !if_any(get_indicators(s), is_marked) && !(as.character(PSPORT) == s) ~ sport
#       ))
# }

```


```{r}
# scoring:
  # Extreme positive response: +2
  # Moderate positive response: +1
  # Neutral/No response: +0
  # Moderate negative response: -1
  # Extreme negative response: -2

for(v in names(df_sports)){
  if(!(startsWith(v, "PSPORT"))){
      df_sports <- df_recoded(df_sports, v)
  }
}

for(v in names(df_sports)){
  if(startsWith(v, "CESD") || startsWith(v, "MPSQ") || startsWith(v, "TEOSQ") || startsWith(v, "GENRI")){
    df_sports[,v] <- as.numeric(as.character(df_sports[,v]))
  }
}

# compute mental health "score" for each student
df_sports <- df_sports %>%
  mutate(`Mental Health Score` = rowSums(dplyr::select(., starts_with("CESD")), na.rm = TRUE)) %>%
  mutate(`Motivation Score` = rowSums(dplyr::select(., starts_with("MPSQ")), na.rm = TRUE)) %>%
  mutate(`Success Score` = rowSums(dplyr::select(., starts_with("TEOSQ")), na.rm = TRUE)) %>%
  mutate(`Risk Behavior Score` = rowSums(dplyr::select(., starts_with("GENRI")), na.rm = TRUE))

#add sport_type to df_sports
individual_sport <- c('Boxing', 'Bowling','Cross Country', 'Dance', 'Golf', 'Gymnastics', 'Skiing', 'Swimming', 'Tennis', 'Track', 'Wrestling', 'Equestrian', 'Figure Skating', 'Snowboarding', 'Weightlifting', 'Ping Pong')

drop_sports <- c( "Other", "Cross Country", "Boxing", "Badminton", "Bowling", "Handball", "Gymnastics", "Equestrian", "Weightlifting", "Rowing", "Cricket", "Colorguard", "Ping Pong", "Figure Skating")

df_sports <- df_sports %>% 
  mutate(sport_group = ifelse(df_sports$PSPORT %in% individual_sport, 'Individual', 'Team')) 


```


## Who took this survey?

```{r}
##Demographics breakdown
library(ggthemes)

df <- df %>% mutate(RACE = fct_recode(RACE, 
                         `White` = "(4) White or Caucasian",
                         `Asian American` = "(2) Asian American or Pacific Islander",
                         `Black / African American` = "(3) Black or African American",
                         `American Indian / Other` = "(6) American Indian / Native American / Other",
                         `Mixed` = "(5) Mixed race"))

s1<- ggplot(df, aes(AGE)) +
  geom_bar(fill = "#6BAED6") +
  xlab("Age") +
  ylab("") +
  theme_classic() +
  scale_x_continuous(breaks=seq(17,25,1)) 

s2<- ggplot(df, aes(fct_recode(SEX, 
                                  `Male` = "(0) Male" , 
                                  `Female` = "(1) Female"))) +
  geom_bar(fill = "#6BAED6") +
  xlab("Gender") +
  ylab("") +
  theme_classic()

s3<- ggplot(df, aes(fct_inorder(RACE))) +
  geom_bar(fill = "#6BAED6") +
  xlab("Race") +
  ylab("") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 20))
  

s4<- ggplot(df, aes(fct_recode(COLYEAR,
                               `Freshman` = "(1) Freshman",
                               `Sophomore` = "(2) Sophomore", 
                               `Junior` = "(3) Junior", 
                               `Senior` = "(4) Senior",
                               `Other` = "(5) Other"))) + 
  geom_bar(fill = "#6BAED6") +
  xlab("Year in College") +
  ylab("") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

grid.arrange(s1, s2, s3, s4, ncol=2, top = textGrob("Respondents Demographic Information"))

```

Students who took part in this survey are within the age range of College Students as is expected. Some older students who participated in the study may include graduate students and some students who started college later than their peers or are taking extra time to finish. The breakdown between men and women is fairly evenly split, which is nice to see. The majority of respondents were white, which may lead to some biases in responses, particularly because mental health is known to have strong correlations with economic status and race. However, when you consider this is a survey given to students at Northeastern University, a private university in Boston, in 2006 it could be feasible that this breakdown represented the student population at that time, especially for athletes and those interested in sports. Lastly, we see from the demographics that we have a majority of underclassmen who took the survey (Freshman, Sophomore) which may also lead to biased results as the stresses of college, adult life, and a persons relationship to sport likely change between Freshman and Senior years of college. 

Now that we know a little bit about the demographics of respondents, lets take a look at what sports they participated in:

```{r}
#Athlete Breakdown Introduction
#primary sports of all respondents

df_sports %>% 
  drop_na(PSPORT) %>% 
  ggplot(aes(x=fct_rev(fct_infreq(PSPORT)))) +
  geom_bar(fill = "#6BAED6") + # color = "#2171b5"
  coord_flip() +
  ggtitle("Primary Sport Indicated by Students") +
  ylab("Count") +
  xlab("Sport") +
  theme_classic(10) +
  theme(plot.title = element_text(hjust = 0.5))

#update df_sports to take out sports below threshold
df_sports <- df_sports %>% 
  filter(!(PSPORT %in% drop_sports))

```

Students selected a wide variety of sports as their Primary Sport. Each student was only able to elect one sport, however we are not displaying those who did not select any sport as we will only be looking at students with a primary sport. We can see that some sports had relatively low response rates and because of that we will exclude all Sports below (and including) 'Other' on this list, that is sports with less than 9 responses. Although Skiing has 9 responses, we have kept it in the analysis because of its close proximity to Snowboarding. 

We see that the most popular sports are Basketball, Soccer, Football and Baseball. This makes sense for an American University! 


## Investigating Mental Health (MH) Responses 

Our primary questions of interest surround how aspects of sport, performance, and team correlate with Mental Health Indicators. As part of the survey given to students, there were 10 questions that were meant to assess each students mental health. Students were asked to respond to the following prompt:

`"Below is a list of some of the ways you may have felt or behaved recently. Please indicate how often you have felt this way during the past week."`


```{r}
#subset to MH response data
MH_responses <- as.data.frame(df) %>%
  dplyr::select("CASEID", starts_with("CESD"), "PSPORT", "SEX", "COLYEAR", "RACE") %>%
  mutate(PSPORT = fct_recode(PSPORT,
          `Badminton` = "(01) Badminton",                          
          `Baseball` = "(02) Baseball",
          `Basketball` = "(03) Basketball",
          `Bowling` = "(04) Bowling",
          `Boxing` = "(05) Boxing / Martial arts",
          `Cheerleading` = "(06) Cheer / Spirit",
          `Cross Country` = "(07) Cross country",
          `Dance` = "(08) Dance team",
          `Equestrian` = "(09) Equestrian",
          `Field Hockey` = "(11) Field hockey",
          `Figure Skating` = "(12) Figure skating",
          `Football` = "(13) Football",
          `Golf` = "(14) Golf",
          `Gymnastics` = "(15) Gymnastics",
          `Ice Hockey` = "(16) Ice hockey / Roller hockey",
          `Lacrosse` = "(17) Lacrosse",
          `Rugby` = "(18) Rugby",
          `Skiing` = "(19) Skiing",
          `Soccer` = "(20) Soccer",
          `Softball` = "(21) Softball",
          `Swimming` = "(22) Swimming / Diving",
          `Tennis` = "(23) Tennis / Racquetball",
          `Track` = "(24) Track and field",
          `Volleyball` = "(25) Volleyball",
          `Wrestling` = "(26) Wrestling",
          `Snowboarding` = "(27) Snowboarding",
          `Weightlifting` = "(28) Weightlifting",
          `Handball` = "(29) Handball",
          `Rowing` = "(30) Rowing / Crew",
          `Cricket` = "(31) Cricket",
          `Ping Pong` = "(32) Ping pong",
          `Colorguard` = "(33) Color / Winterguard",
          `Other` = "(66) Other sport")) %>%
  mutate(sport_group = 
           ifelse(PSPORT %in% individual_sport, 'Individual', 'Team')) %>%
  filter(!(PSPORT %in% drop_sports)) %>%
  rename("Bothered by things that \n usually don't bother me" = CESD01,
        "Trouble keeping mind on \n what I was doing" = CESD02,
        "Depressed" = CESD03,
        "Everything was an effort" = CESD04,
        "Hopeful about future" = CESD05,
        "Fearful" = CESD06,
        "Sleep was restless" = CESD07,
        "Happy" = CESD08,
        "Lonely" = CESD09,
        "Could not get going" = CESD10) %>%
  drop_na() 

MH_pivot <- MH_responses[,c(1:11)] %>% 
  pivot_longer(!CASEID, names_to="Questions", values_to="Answer") %>%
  group_by(Questions, Answer) %>%
  summarize(Count=n()) %>%
  mutate(Answer = fct_recode(Answer, 
              `1-Rarely or none \n of the time` = "(1) Rarely or none of the time (less than 1 day)",
              `2-Some or a little \n of the time` = "(2) Some or a little of the time (1-2 days)",
              `3-Occasionally or \n moderate amount \n of time` = "(3) Occasionally or a moderate amount of time (3-4 days)", 
              `4 All of \n the time` = "(4) All of the time (5-7 days)"))

ggplot(MH_pivot) +
  geom_bar(aes(x = reorder(Questions, Count), y=-Count, fill=Answer), color="black", position="stack", stat="identity") +
  coord_flip() + 
  ggtitle("Survey Responses to MH Questions") +
  ylab("") +
  xlab("Feelings or Behaviors") +
  scale_fill_brewer(palette="Blues") +
  theme_classic() +
  theme(legend.position= "bottom", legend.justification = "left", axis.text.x=element_blank(), axis.ticks.x=element_blank(), 
        plot.title = element_text(hjust = 0.5))

```

In this plot we can view the proportion of responses from all students across all the mental health questions from the survey. We see that many of the negative feelings, like Depressed or Fearful, have "Rarely or none of the time" as the most frequent answer provided. Whereas, positive outlooks, like Happy or Hopeful about future, have relatively low "Rarely or none of the time", but most of the responses lie in "Occasionally". Happy and Hopeful are also the two questions that the largest proportions of "All the time" across all questions. 

We also attempted faceting and filtering by different sport types and gender, but did not see significant differences to warrant including it here. This showed us that on a macro scale and from a proportion perspective, students answered these questions relatively similarly. 

Note about plot: We recognize that part of the legend got cut off in the rendered book, however in the .Rmd file is shows up fully, we are unsure why this is the case. The full text for legend box 4 is: "All of the time". 


```{r}
#view MH responses for team vs. individual sports 

# MH_pivot_team <- MH_responses[] %>% 
#   pivot_longer(!c(CASEID, sport_group, PSPORT), names_to="Questions", values_to="Answer") %>%
#   group_by(Questions, Answer, sport_group) %>%
#   summarize(Count=n()) %>%
#   ungroup() %>%
#   mutate(Answer = fct_recode(Answer, 
#               `1-Rarely or none \n of the time` = "(1) Rarely or none of the time (less than 1 day)",
#               `2-Some or a little \n of the time` = "(2) Some or a little of the time (1-2 days)",
#               `3-Occasionally or \n moderate amount \n of time` = "(3) Occasionally or a moderate amount of time (3-4 days)", 
#               `4 All of \n the time` = "(4) All of the time (5-7 days)")) 

# #ggplot(MH_pivot_team) +
#   geom_bar(aes(x = reorder(Questions, Count), y=-Count, fill=Answer), color="black", position="stack", stat="identity") +
#   facet_grid(~sport_group, scales = "free_x") +
#   coord_flip() + 
#   ggtitle("Survey Responses to MH Questions") +
#   ylab("") +
#   xlab("Questions") +
#   scale_fill_brewer(palette="Blues") +
#   theme_classic() +
#   theme(legend.position= "bottom", legend.justification = "left", axis.text.x=element_blank(), axis.ticks.x=element_blank(),
#         plot.title = element_text(hjust = 0.5))


```

```{r}
# MH_pivot_dt <- MH_responses[] %>% 
#   pivot_longer(!c(CASEID, sport_group, PSPORT), names_to="Questions", values_to="Answer") %>%
#   group_by(Questions, Answer, PSPORT) %>%
#   summarize(Count=n()) %>%
#   ungroup() %>%
#   mutate(Answer = fct_recode(Answer, 
#               `1-Rarely or none \n of the time` = "(1) Rarely or none of the time (less than 1 day)",
#               `2-Some or a little \n of the time` = "(2) Some or a little of the time (1-2 days)",
#               `3-Occasionally or \n moderate amount \n of time` = "(3) Occasionally or a moderate amount of time (3-4 days)", 
#               `4 All of \n the time` = "(4) All of the time (5-7 days)")) %>%
#   filter(PSPORT == "Dance" | PSPORT == "Track")

# #ggplot(MH_pivot_dt) +
#   geom_bar(aes(x = reorder(Questions, Count), y=-Count, fill=Answer), color="black", position="stack", stat="identity") +
#   facet_grid(~PSPORT, scales = "free_x") +
#   coord_flip() + 
#   ggtitle("Survey Responses to MH Questions") +
#   ylab("") +
#   xlab("Questions") +
#   scale_fill_brewer(palette="Blues") +
#   theme_classic() +
#   theme(legend.position= "bottom", legend.justification = "left", axis.text.x=element_blank(), axis.ticks.x=element_blank())

```



## Investigating Sport Motivation, Perspectives on Success, Behavior Patterns, and Mental Health for Athletes 

In effort to assess how factors related to sport and sport performance are related to an athletes mental health, we created a scoring formula for all students based on their responses to the survey questions:

Mental Health Score -- Mental Health questions were posed in the following manner: 

`"Below is a list of some of the ways you may have felt or behaved recently. Please indicate how often you have felt this way during the past week."`

Based on the feeling, we assigned scores that were positive to indicate positive mental health outlook versus negative scores to indicate a negative outlook on mental health. For example, if a respondent answered "I was happy" with "All of the time" they would get +2 points, versus a response of "Rarely or None of the Time" would get -2 points. In summary, a high mental health score denotes a positive mental health outlook.

Internal Motivation Score -- The Motivation Score comes from questions surrounding reasons for participating in a student's sport of choice:

`"People have many different reasons for participating in sports. Below are listed some of those possible reasons. How important is each of these reasons for you? I participate in sports because . . ."` 

Students only answered these questions if they participated in at least one season of their sport since the beginning of High School. If a student did not respond to these questions, they were removed from this particular analysis. The motivation score identified questions that highlighted questions that focused on motivation for participation coming from within the student, like to relax, to build a career, or because it was fun,  versus motivation for participation coming from external sources, like doing it for parents, to impress others, for friends, etc. Scores were set similarly to those for the mental health score where higher values were given to responses that favored internal motivation and lower (negative) values were given to responses that favored external motivating factors. In summary, a high motivation score indicated strong internal motivation for participation. 

Risk Averse Score -- The Risk tolerance score comes from questions assessing a students feelings about risk taking and violence:

`"The items in this section are about your actions, feelings, and beliefs in general. There are no right or wrong responses to the statements. You should give the responses that most accurately describe your personal actions, feelings, and beliefs. It is best if you respond with your first impression when answering. Thinking about your own actions, feelings and beliefs please indicate how much you personally agree or disagree with each statement."` 

Questions were grouped into cautious and risky groups, where agreement responses for cautious questions (i.e. Strongly Agree with I prefer to be safe and careful) got high scores, while agreement responses for risky questions (i.e. Strongly Agree with I enjoy taing risks) were given negative scores. In summary, a high risk score indicated a risk averse individual, where a low risk score indicated an individual who enjoyed risk taking and may be in favor of violent behavior under certain circumstances. 

Success through Hardwork Score -- The success score comes from questions about how the student felt about their athletic success: 

`"People have different ideas about what athletic "success" means, other than simply winning or losing a competition. Think about the times when you have felt most successful in sport. How well does each of the following statements describe your feelings? I feel most successful in sport when . . ."` 

Feelings were assigned into hardwork or ego groupings. Hardwork related feelings included things like, I learn a new skill and it makes me want to practice more. Ego related feelings were things like, Others mess up and I don't. Higher score values were given to strong agreement with hardwork feelings, where negative scores were given to strong agreement with ego related feelings. In summary, a high score in success denotes that the student felt athletic success was related to hardwork and training, while low success scores tended to view success more due to their ability to simply be better than others.  

After creating these scores, we took a look at their correlation pattern:

```{r}
#Primary Sport Analysis

df_scores <- df_sports %>%
  dplyr::select("CASEID", "PSPORT", "Mental Health Score", "Motivation Score", "Success Score", "Risk Behavior Score", "sport_group") %>%
  group_by(PSPORT) %>%
  mutate(avg_mh = mean(`Mental Health Score`)) %>%
  group_by(PSPORT) %>%
  mutate(avg_motiv = mean(`Motivation Score`)) %>%
  group_by(PSPORT) %>%
  mutate(avg_success = mean(`Success Score`)) %>%
  group_by(PSPORT) %>%
  mutate(avg_risk = mean(`Risk Behavior Score`)) %>%
  distinct(CASEID, PSPORT, .keep_all = TRUE)

```

```{r}
#correlation plots for MH scores

#calculate pairwaise correlation values for mh score columns and store as matrix 
MH_corr <- df_scores[,c(8:11)] %>%
  rename(`Mental Health Score` = "avg_mh", 
         `Motivation Score` = "avg_motiv", 
         `Outlook on Success Score` = "avg_success",
         `Risk Avoidance Score` = "avg_risk") %>%
  cor(., use = "pairwise.complete.obs")

#plot, lower values only, with labels, and note insignificant values as white
ggcorrplot(MH_corr, hc.order = TRUE, type = "lower", colors = c("coral3", "grey99", "royalblue1"), lab = TRUE, insig = "blank") + 
  ggtitle("Correlation Between Assessment Types Across Team Averages") +
  theme(plot.title = element_text(hjust = 0.5))

```

There is some light correlation across all the scores, however not as strong of correlations as we had hoped with the Mental Health Score. The strongest correlation for mental health, according to our metric, was between mental health and motivation for participation at +0.70. Interestingly, a high mental health score is (loosely) negatively correlated with the risk score, meaning high mental health is loosely correlated with more risky behavior. 

Overall, the strongest correlation was between motivation for participation and views on success at +0.85. Higher scores in these two categories mean motivation for sport participation is coming from within (versus external motivation) and that success is viewed from the lens of hardwork and training (versus pure skill or talent), respectively. This makes sense intuitively because if someone has internal motivation to do something, they likely use that motivation to work at whatever the skill or task is. 

It is important to note however that these values come from our manual creation of these scores, so there may be some inherent bias in the way we selected questions for categories and perhaps also that we did not weight certain questions more than others. In a future iteration, it could be helpful to be more precise about our scoring metric. 


### Health & Life Outlook Scores by Sport Type

```{r}
df_score_pivot <- df_scores[,c(1:2, 7:11)] %>%
  pivot_longer(!c(PSPORT,sport_group, CASEID), names_to="Assessment", values_to="Score") %>%
  group_by(PSPORT) %>%
  mutate(Assessment = as.factor(Assessment)) %>%
  mutate(Assessment = fct_recode(Assessment, 
                                `Mental Health \n Score` = "avg_mh",
                                `Motivated Internally` = "avg_motiv",
                                `Risk Averse` = "avg_risk",
                                `Success \n Through Hardwork` = "avg_success")) %>%
  filter(!PSPORT == "NA")


# #single plot side by side bar chart with average intercepts
# ggplot(data = df_score_pivot) +
#   geom_col(aes(x = PSPORT, y = Score, fill = Assessment), color = "black", position="dodge", size = .25) +
#   facet_grid(~sport_group, scales="free_x", space = "free_x") +
#   geom_hline(yintercept = mean(df_scores$avg_mh), col="grey", size =.25, alpha = 1) +
#   geom_hline(yintercept = mean(df_scores$avg_motiv), col="#bdd7e7", size =.25, alpha = 1) +
#   geom_hline(yintercept = mean(df_scores$avg_risk), col="#6baed6", size =.25, alpha = 1) +
#   geom_hline(yintercept = mean(df_scores$avg_success), col="#2171b5", size =.25, alpha = 1) +
#   theme_classic(9) +
#   theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "bottom", plot.title = element_text(hjust = 0.5)) +
#   ggtitle("Health & Life Outlook Scores Across Sports") +
#   ylab("Average Score") +
#   xlab("Sport") +
#   scale_fill_brewer(palette="Blues") 

#dotplot view & separate into two plots for easier reading
ggplot(data = df_score_pivot) +
  geom_point(aes(x = fct_reorder2(PSPORT, fct_rev(Assessment), -Score), y = Score, color = Assessment), size = 2) +
  facet_wrap(~sport_group, nrow = 2, scales = "free_y") +
  coord_flip() +
  theme_bw(9) +
  theme(legend.position = "bottom", plot.title = element_text(hjust = 0.5)) +
  ggtitle("Health & Sport Outlook Scores Across Sports") +
  ylab("Average Score") +
  xlab("Sport") +
  scale_color_brewer(palette="Set2") 

```

This plot shows the average scores per sport across individual and team sports respectively and is sorted by average mental health scores since this is the score we are most interested in understanding. 

Our hypothesis going into our analysis, was that individual sports may have worse mental health indicators than team sports because team sport players have team members to lean on and commiserate with when things are hard or when faced with a loss. Whereas an individual must compete for themselves and does not have teammates to help pick up the slack when things get tough. However, this dataset and our formulation of the mental health metric rejects that hypothesis! We see here that team and individual sports have very similar mental health scores. Interestingly, Rugby has the highest mental health score out of all sports! 

Another interesting takeaway we can glean from this visualization, is the amount of sports the correlate with positive feelings towards risky behavior and violence. Based on previous knowledge and research, we anticipated that football, rugby, wrestling, and ice hockey would be on the riskier side due to the violent aspects of their sport and sport cultures however golf and snowboarding were unexpected additions to this list. 

Skiing has the motivation score, signalling that they are motivated to ski competitively through internal factors and feelings. Whereas golf came in with the lowest ranking for motivation, signalling that they are motivated by more external factors to play golf however, their average score is still positive, so while they are more motivated by external factors, they are still overall on the internal motivation side of things. 

As was alluded to in our correlation plot, it is difficult to see correlation between these scores within either a sport or within the sport group of team or individual. So we wondered if perhaps grouping by gender would be a better indicator for these assessments. We hand selected sports that had representation across both genders (in addition we also added Baseball and Softball as comparable sports for male and female respectively). 

### Health & Life Outlook Scores by Gender

```{r}
#look into male vs female breaks... 
df_score_gender<- df_sports %>%
  dplyr::select("CASEID", "PSPORT", "Mental Health Score", "Motivation Score", "Success Score", "Risk Behavior Score", "sport_group", "SEX") %>%
  group_by(PSPORT, SEX) %>%
  mutate(avg_mh = mean(`Mental Health Score`)) %>%
  group_by(PSPORT, SEX) %>%
  mutate(avg_motiv = mean(`Motivation Score`)) %>%
  group_by(PSPORT, SEX) %>%
  mutate(avg_success = mean(`Success Score`)) %>%
  group_by(PSPORT, SEX) %>%
  mutate(avg_risk = mean(`Risk Behavior Score`)) %>%
  distinct(CASEID, PSPORT, SEX, .keep_all = TRUE) %>%
  drop_na()

df_score_pivot2 <- df_score_gender[,c(1:2, 8:12)] %>%
  pivot_longer(!c(PSPORT, CASEID, SEX), names_to="Assessment", values_to="Score") %>%
  group_by(PSPORT) %>%
  mutate(Assessment = as.factor(Assessment)) %>%
  mutate(Assessment = fct_recode(Assessment, 
                                `Mental Health \n Score` = "avg_mh",
                                `Motivated Internally` = "avg_motiv",
                                `Risk Averse` = "avg_risk",
                                `Success \n Through Hardwork` = "avg_success")) %>%
  mutate(SEX = fct_recode(SEX, 
                          Male = "(0) Male",
                          Female = "(1) Female")) %>%
  filter(PSPORT %in% c("Basketball", "Golf", "Boxing", "Rugby", "Soccer", "Swimming", "Track", "Lacrosse", "Volleyball", "Baseball", "Softball"))


#try side by side bar chart
# ggplot(data = df_score_pivot2) +
#   geom_col(aes(x = PSPORT, y = Score, fill = Assessment), color = "black", position="dodge", size = .25) +
#   facet_wrap(~SEX, scales="free_x") +
#   theme_classic(9) +
#   theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "bottom", plot.title = element_text(hjust = 0.5)) +
#   ggtitle("Health & Life Outlook Scores for Select Sports by Gender") +
#   ylab("Average Score") +
#   xlab("Sport") +
#   scale_fill_brewer(palette="Blues") 

#try dotplot
ggplot(data = df_score_pivot2) +
  geom_point(aes(x = fct_reorder2(PSPORT, fct_relevel(Assessment, "Risk Averse", after = Inf), -Score), y = Score, color = Assessment), 
             size = 2) +
  facet_wrap(~SEX, nrow = 2, scales = "free_y") +
  coord_flip() +
  theme_bw(9) +
  theme(legend.position = "bottom", 
        plot.title = element_text(hjust = 0.5)) +
  ggtitle("Health & Sport Outlook Scores for Select Sports by Gender") +
  ylab("Average Score") +
  xlab("Sport") +
  scale_color_brewer(palette="Set2")

```

There is one assessment that clearly differs between men and women: risk tolerance! This graph is sorted in decreasing order by Risk Aversion scores in Sports (see note below). For all sports that have male and female participants, the males are more risk tolerant (i.e. favor risky situations and/or violence) than the females are. This outcome is not incredibly surprising, however it is interesting to see that no female sport averages fell into the negative area at all. The closest were female rugby players. Based on the nature of rugby, this seems reasonable. 

For some sports like soccer, females have a lower mental health score than males in their sport, however this is not consistent across all sports. When we compare basketball we see that female basketball players have a higher mental health score. So we cannot say that that one or the other gender has better or worse mental health outlooks. 

<<<<<<< HEAD
Male swimmers were the only ones who scored more towards the ego or pure talent perspective on athletic success. 

Note about plot: We were unable to successfully sort by decreasing Risk Scores across both facets. Research online seemed to indicate this may be a wider issue with ggplot, facets, and factor ordering. Nonetheless, our intention was to sort by Risk Score in decreasing order. 

Because of the stark difference in male and females in sports like Rugby and Lacrosse we took a look at how they answered survey questions: 
=======
Because of the stark difference in male and females in sports like Rugby and Lacrosse we took a look at how they answered survey questions. Blue alluvium correspond to male respondents, and red alluvium correspond to female respondents.
>>>>>>> 9010e72ee9e5bfa6731c9d1bb727b1380c54bc39

```{r, out.width = 100%}
Risk_responses <- as.data.frame(df) %>%
  dplyr::select("CASEID", starts_with("GENRI"), "PSPORT", "SEX") %>%
  mutate(PSPORT = fct_recode(PSPORT,
          `Badminton` = "(01) Badminton",
          `Baseball` = "(02) Baseball",
          `Basketball` = "(03) Basketball",
          `Bowling` = "(04) Bowling",
          `Boxing` = "(05) Boxing / Martial arts",
          `Cheerleading` = "(06) Cheer / Spirit",
          `Cross Country` = "(07) Cross country",
          `Dance` = "(08) Dance team",
          `Equestrian` = "(09) Equestrian",
          `Field Hockey` = "(11) Field hockey",
          `Figure Skating` = "(12) Figure skating",
          `Football` = "(13) Football",
          `Golf` = "(14) Golf",
          `Gymnastics` = "(15) Gymnastics",
          `Ice Hockey` = "(16) Ice hockey / Roller hockey",
          `Lacrosse` = "(17) Lacrosse",
          `Rugby` = "(18) Rugby",
          `Skiing` = "(19) Skiing",
          `Soccer` = "(20) Soccer",
          `Softball` = "(21) Softball",
          `Swimming` = "(22) Swimming / Diving",
          `Tennis` = "(23) Tennis / Racquetball",
          `Track` = "(24) Track and field",
          `Volleyball` = "(25) Volleyball",
          `Wrestling` = "(26) Wrestling",
          `Snowboarding` = "(27) Snowboarding",
          `Weightlifting` = "(28) Weightlifting",
          `Handball` = "(29) Handball",
          `Rowing` = "(30) Rowing / Crew",
          `Cricket` = "(31) Cricket",
          `Ping Pong` = "(32) Ping pong",
          `Colorguard` = "(33) Color / Winterguard",
          `Other` = "(66) Other sport")) %>%
  rename("I'm happiest when \n risking danger" = GENRIS01,
        "I believe violence \n is never justified" = GENRIS02,
        "I prefer to be safe and careful" = GENRIS03,
        "I enjoy taking risks" = GENRIS04,
        "I never take chances" = GENRIS12,
        "I am disgusted \n by violence" = GENRIS13,
        "It is foolish to take risks" = GENRIS14,
        "I like fighting" = GENRIS15,
        "Sometimes violent \n action is necessary" = GENRIS11, 
        "Taking dangerous risks \n helps me prove myself" = GENRIS06) %>%
  mutate(SEX = fct_recode(SEX,
                          Male = "(0) Male",
                          Female = "(1) Female")) %>%
  drop_na()

plot_list <- c("I'm happiest when \n risking danger","I believe violence \n is never justified",
        "I prefer to be safe and careful",
        "I enjoy taking risks",
        "I never take chances",
        "I am disgusted \n by violence",
        "It is foolish to take risks",
        "I like fighting",
        "Sometimes violent \n action is necessary", 
        "Taking dangerous risks \n helps me prove myself")

Risk_pivot <- Risk_responses[] %>%
  pivot_longer(!c(CASEID, SEX, PSPORT), names_to="Question", values_to="Score") %>%
  group_by(CASEID, SEX, PSPORT, Question, Score ) %>%
  summarize(Freq = n()) %>%
  ungroup() %>%
  filter(Question %in% plot_list) %>%
  mutate(Score = fct_recode(Score, 
                            `Strongly Disagree` = "(1) Strongly Disagree", 
                            `Disagree` = "(2) Disagree",
                            `Agree` = "(3) Agree", 
                            `Strongly Agree` = "(4) Strongly Agree")) %>%
  mutate(Question = fct_relevel(Question, "I am disgusted \n by violence", "I believe violence \n is never justified", "I prefer to be safe and careful",  "It is foolish to take risks", "I never take chances" , after =0))


#try Risk Questions!
ggplot(data = (Risk_pivot %>% filter(PSPORT == "Rugby")), aes(x = Question, stratum = fct_rev(Score), alluvium = CASEID,
                          y = Freq, 
                      fill = SEX, label = Score)) +
  geom_alluvium() +
  #coord_flip() +
  geom_stratum(fill = "seashell", color = "black") +
  geom_text(stat = "stratum", size = 2.5, angle = 0) +
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "bottom", 
        axis.text.y = element_blank(), axis.ticks.y = element_blank(), plot.title = element_text(hjust = 0.5)) +
  ylab("") +
  ggtitle("Survey Response Path for Risk Questions - Rugby")

ggplot(data = (Risk_pivot %>% filter(PSPORT == "Lacrosse")), aes(x = Question, stratum = fct_rev(Score), alluvium = CASEID,
                          y = Freq, 
                      fill = SEX, label = Score)) +
  geom_alluvium() +
  #coord_flip() +
  geom_stratum(fill = "seashell", color = "black") +
  geom_text(stat = "stratum", size = 2.5, angle = 0) +
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "bottom", 
        axis.text.y = element_blank(), axis.ticks.y = element_blank(), plot.title = element_text(hjust = 0.5)) +
  ylab("") + 
  ggtitle("Survey Response Path for Risk Questions - Lacrosse")

# ggplot(data = (MH_pivot2 %>% filter(PSPORT == "Rugby")), aes(x = Assessment, stratum = fct_rev(Score), alluvium = CASEID,
#                           y = Freq, 
#                       fill = SEX, label = Score)) +
#   geom_alluvium() +
#   #coord_flip() +
#   geom_stratum(fill = "seashell", color = "black") +
#   geom_text(stat = "stratum", size = 2.5, angle = 0) +
#   theme_bw() + 
#   theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "none") +
#   ggtitle("Survey Response Path for Mental Health Questions - Rugby")
# 
# ggplot(data = (MH_pivot2 %>% filter(PSPORT == "Golf")), aes(x = Assessment, stratum = fct_rev(Score), alluvium = CASEID,
#                           y = Freq, 
#                       fill = SEX, label = Score)) +
#   geom_alluvium() +
#   #coord_flip() +
#   geom_stratum(fill = "seashell", color = "black") +
#   geom_text(stat = "stratum", size = 2.5, angle = 50) +
#   #scale_fill_brewer(palette = "Set2") +
#   theme_bw() +
#   theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "bottom") +
#   ggtitle("Survey Response Path for Mental Health Questions - Golf")
# 
# ggplot(data = (MH_pivot2 %>% filter(PSPORT == "Track")), aes(x = Assessment, stratum = fct_rev(Score), alluvium = CASEID,
#                           y = Freq, 
#                       fill = SEX, label = Score)) +
#   geom_alluvium() +
#   #coord_flip() +
#   geom_stratum(fill = "seashell", color = "black") +
#   geom_text(stat = "stratum", size = 2.5, angle = 50) +
#   #scale_fill_brewer(palette = "Set2") +
#   theme_bw() +
#   theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "bottom") +
#   ggtitle("Survey Response Path for Mental Health Questions - Track")


```

The questions are ordered from left to right in a general decreasing order of risk aversion; questions opposing risk and violence can be found on the left, more neutral questions can be found in the middle, and questions supporting risks and violence can be found on the right.

<<<<<<< HEAD
In viewing the alluvial plot of responses of rugby players shows that many players answered questions similarly, particularly with questions that assess more extreme like or dislike of risk or violence. For example, There is little variation in the pattern of how the right-most four questions were answered. Also, observe the stark split in male (blue) and female (red) repsonses on the right side of the graph. There appears to be a 50-50 split in the gender of repondents who disagreed, but the only Rugby players in strong agreement were male, and the only players in strong disagreement were female. There is variation in the more neutral questions, and some of there is a general switch of yes and no answers among respondents at the left-most extreme; that is, some who answered "yes" to high-risk questions answered "no" to high-caution questions, and vise versa.
=======
In viewing the alluvial plot of responses of rugby players shows that many players answered questions similarly, particularly with questions that assess more extreme like or dislike of risk or violence. For example, There is little variation in the pattern of how the right-most four questions were answered. Also, observe the stark split in male (blue) and female (red) repsonses on the right side of the graph. There appears to be a 50-50 split in the gender of repondents who disagreed, but the only Rugby players in strong agreement were male, and the only players in strong disagreement were female. There is variation in the more neutral questions, and some of there is a general switch of yes and no answers among respondents at the left-most extreme; that is, some who answered "yes" to high-risk questions
answered "no" to high-caution questions, and vise versa.

The responses among lacross players were more individual; there are fewer sections where several players answered several questions similarly. Still, it can be seen that more male respondents agreed with the high-risk questions, and more female respondents disagreed; the converse appears to be true with high-caution questions.

Note that these two sports have a similar number of respondents, making them good candidates for comparison.
>>>>>>> 9010e72ee9e5bfa6731c9d1bb727b1380c54bc39

The responses among lacrosse players were more individual; there are fewer sections where several players answered several questions similarly. Still, it can be seen that more male respondents agreed with the high-risk questions, and more female respondents disagreed; the converse appears to be true with high-caution questions.

Note that these two sports have a similar number of respondents, making them good candidates for comparison.

### Health & Life Outlook Scores by College Year

```{r}
#recalculating means to account for new check between year in college and score
df_score_year<- df_sports %>%
  dplyr::select("CASEID", "PSPORT", "Mental Health Score", "Motivation Score", "Success Score", "Risk Behavior Score", "sport_group", "COLYEAR") %>%
  filter(!(PSPORT %in% drop_sports)) %>%
  group_by(PSPORT, COLYEAR) %>%
  mutate(avg_mh = mean(`Mental Health Score`)) %>%
  group_by(PSPORT, COLYEAR) %>%
  mutate(avg_motiv = mean(`Motivation Score`)) %>%
  group_by(PSPORT, COLYEAR) %>%
  mutate(avg_success = mean(`Success Score`)) %>%
  group_by(PSPORT, COLYEAR) %>%
  mutate(avg_risk = mean(`Risk Behavior Score`)) %>%
  distinct(CASEID, PSPORT, COLYEAR, .keep_all = TRUE) %>%
  drop_na()

df_year_pivot <- df_score_year[,c(1:2, 8:12)] %>%
  pivot_longer(!c(PSPORT, CASEID, COLYEAR), names_to="Assessment", values_to="Score") %>%
  group_by(PSPORT) %>%
  mutate(Assessment = as.factor(Assessment)) %>%
  mutate(Assessment = fct_recode(Assessment, 
                                `Mental Health \n Score` = "avg_mh",
                                `Motivated Internally` = "avg_motiv",
                                `Risk Averse` = "avg_risk",
                                `Success \n Through Hardwork` = "avg_success")) %>%
  mutate(COLYEAR = fct_recode(COLYEAR,
                               `Freshman` = "(1) Freshman",
                               `Sophomore` = "(2) Sophomore", 
                               `Junior` = "(3) Junior", 
                               `Senior` = "(4) Senior",
                               `Other` = "(5) Other"))


#ordered by Motivation - however the facets are counted as one score so it looks a bit messy 

ggplot(data = df_year_pivot %>%
         filter(COLYEAR == "Freshman" | COLYEAR == "Senior")) +
  geom_point(aes(x = fct_reorder2(PSPORT, fct_relevel(Assessment, "Motivated Internally", after = Inf), -Score), 
                 y = Score, color = Assessment)) +
  facet_wrap(~COLYEAR, nrow = 2) +
  coord_flip() +
  theme_bw(8) +
  theme(legend.position = "bottom", plot.title = element_text(hjust = 0.5)) +
  ggtitle("Health & Sport Outlook Scores for Athletes by Class Year") +
  ylab("Average Score") +
  xlab("Sport") +
  scale_color_brewer(palette="Set2")

```

<<<<<<< HEAD
Risk Aversion and Internal Motivation saw slight increases from Freshman to Senior. But surprising to us, Freshman and Senior distributions did not actually differ that much. We had assumed that perhaps over the course of college the difference between Freshman and Senior for attributes like Success Through Hardwork may have increased. This plot is sorted by Motivation (see Note), however there doesn't seem to be clear distinction of upward progress between Freshman and Senior years. Important to note however is that these are not the same people in their Freshman and Senior years, but two different sets of people, so it could be that this group of Freshman is exceptionally mature and the Senior immature or simply that there is not as much of a measureable change visible in these years from this dataset.

Note about plot: We were unable to successfully sort by decreasing Motivation Scores across both facets. Research online seemed to indicate this may be a wider issue with ggplot, facets, and factor ordering. Nonetheless, our intention was to sort by Motivation Score in decreasing order. 
=======
Risk Aversion and Internal Motivation saw slight increases from Freshman to Senior. But surprising to us, Freshman and Senior distributions did not actually differ that much. We had assumed that perhaps over the course of college the difference between Freshman and Senior for attributes like Success Through Hardwork may have increased. This plot is sorted by Motivation, however there doesn't seem to be clear distinction of upward progress between Freshman and Senior years. Important to note however is that these are not the same people in their Freshman and Senior years, but two different sets of people, so it could be that this group of Freshman is exceptionally mature and the Senior immature or simply that there is not as much of a measureable change visible in these years from this dataset.
>>>>>>> 9010e72ee9e5bfa6731c9d1bb727b1380c54bc39

### Health & Life Outlook Scores by Race

```{r,  out.width="100%"}
#calculating averages for Race
df_score_race<- df_sports %>%
  dplyr::select("CASEID", "PSPORT", "Mental Health Score", "Motivation Score", "Success Score", "Risk Behavior Score", "sport_group", "RACE") %>%
  filter(!(PSPORT %in% drop_sports)) %>%
  group_by(PSPORT, RACE) %>%
  mutate(avg_mh = mean(`Mental Health Score`)) %>%
  group_by(PSPORT, RACE) %>%
  mutate(avg_motiv = mean(`Motivation Score`)) %>%
  group_by(PSPORT, RACE) %>%
  mutate(avg_success = mean(`Success Score`)) %>%
  group_by(PSPORT, RACE) %>%
  mutate(avg_risk = mean(`Risk Behavior Score`)) %>%
  distinct(CASEID, PSPORT, RACE, .keep_all = TRUE) %>%
  drop_na()

df_race_pivot <- df_score_race[,c(1:2, 8:12)] %>%
  pivot_longer(!c(PSPORT, CASEID, RACE), names_to="Assessment", values_to="Score") %>%
  group_by(PSPORT, Score) %>%
  mutate(Assessment = as.factor(Assessment)) %>%
  mutate(Assessment = fct_relevel(Assessment, 
                                  "avg_mh", "avg_motiv", "avg_risk", "avg_success")) %>%
  mutate(Assessment = fct_recode(Assessment, 
                                `Mental Health \n Score` = "avg_mh",
                                `Motivated Internally` = "avg_motiv",
                                `Risk Averse` = "avg_risk",
                                `Success \n Through Hardwork` = "avg_success")) %>%
  mutate(RACE = fct_recode(RACE,
                              `White` = "(4) White or Caucasian",
                              `Asian American` = "(2) Asian American or Pacific Islander",
                              `Black/ African American` = "(3) Black or African American",
                              `American Indian / Other` = "(6) American Indian / Native American / Other",
                              `Mixed` = "(5) Mixed race"))



ggplot(data = df_race_pivot) +
  geom_point(aes(x = fct_reorder2(PSPORT, fct_rev(Assessment), -Score),
                 y = Score, color = Assessment)) +
  coord_flip() +
  facet_wrap(~RACE, ncol = 1, scales = "free_y", drop = TRUE) +
  theme_bw(7) +
  theme(legend.position = "right" , plot.title = element_text(hjust = 0.5)) +
  ggtitle("Health & Sport Outlook Scores for Athletes by Race") +
  ylab("Average Score") +
  xlab("Sport") +
  scale_color_brewer(palette="Set2")
```

An immediate finding is that the American Indian/Other respondents have multiple sports with significantly lower risk scores than their peers, meaning they are more risk tolerant and risk seeking.

Dance has a noticebly low average mental health score among the Asian American population. Certain styles of dance, namely classical ballet, have a large Asian and Asian American presence worldwide, and dancers often report to have suffered in their mental health due to the physical and emotional demand of the sport. Perhaps this isolated low mental health score reflects this common complaint.

The white respondents have the highest minimum mental health score of among the races. It also has one of the lowest maximum mental health scores, resulting in it being the race with the smallest range of scores for this assessment. This appears to be true for many the other assessments as well. This relative consistency may be a consequence of the race of the respondents, or perhaps it is a consequence of the fact that there around 500 of the 795 respondents were white, so these averages are more demonstrative of a larger population as opposed to being heavily influenced by individual responses.

Generally, aside from the aforementioned observations, the races have comparable ranges and values among the different scores with no undeniable trend. There appears to be a very slight slope throughout all races that mirrors the ordering of sports (set in decreasing order of average mental health score among white respondents), but it is too subtle to draw conclusions about. Also, note that this ordering has a few sports out of order which can be seen in mental health dots (green) misplaced from the diagonal, but the desired effect is there.

It would be interesting to take these plots a step further by including the mean values of scores among the sports, both within the faceted plots and among all observations. The inclusion of mean lines detracts from the readability of these static plots, but it may be insightful in an animated or interactive plot.

Note about plot: We were unable to successfully sort by decreasing Mental Health Scores across facets. Research online seemed to indicate this may be a wider issue with ggplot, facets, and factor ordering. Nonetheless, our intention was to sort by Mental Health in decreasing order across all facets.
